# **고전 암호**

* ### 고전 암호는 컴퓨터와 같은 고성능 연산 장치가 발명되기 전에, 비교적 간단한 기계와 손 등으로 암복호화를 수행하던 암호를 말한다.

* ### 대부분 컴퓨터를 사용하면 쉽게 복호화되기 때문에 현대에는 사용되지 않는다.

* ### 고전 암호는 일반적으로 치환(Substitution)과 전치(Transposition)의 방법으로 설계된다. 치환은 평문의 문자를 다른 문자로 바꾸는 것, 전치는 평문 문자들의 위치를 바꾸는 것을 말한다.

* ### 단순한 고전 암호는 한 가지 원리만을 사용하는 치환 암호, 또는 전치 암호 이고 복잡한 고전 암호는 두 원리를 모두 사용 한다.

* ### 치환 암호는 단일 문자 치환 암호, 다중 문자 치환 암호로 나누어진다.


<br>

![이미지](https://kr.object.ncloudstorage.com/dreamhack-content/page/d6efb28a5db8c43dda752789174bba427d970d78f4d3ffb120e3f154dea7d18a.png)

<br>

<br>

- - -

<br>

  ## **단일 문자 치환 암호**

<br>

* ### 단일 문자 치환 암호(Monoalphabetic Substitution  Cipher)는 평문의 각 문자를 약속된 다른 문자로 치환하는 암호이다.

* ### 복호화를 위해 치환의 대응 관계는 일대일 대응이며, 평문의 'A'가 암호문의 'B'로 치환된다면, 평문의 다른 어떤 문자도 'B'로 치환되지 않는다.

<br>

- - -

<br>

## 카이사르 암호

<br>

* ### 단일 문자 치환 암호의 대표적인 예로, 기원전 44년 줄리어스 카이사르가 사용한 카이사르 암호(Caesar Cipher)가 있다.

* ### 카이사르 암호는 평문의 각 알파벳을 일정한 거리만큼 밀어서 다른 알파벳으로 치환하는데, 이를 복호화할 때는 암호문의 각 문자를 다시 원래 위치로 밀어서 평문을 구한다.

* ### 송수신자가 몇 칸을 밀 것인지를 사전에 합의해야 통신이 이뤄질 수 있다.

* ### 카이사르 암호는 알파벳을 밀어낸 횟수만 알면 해독할 수 있는데, 알파벳을 밀어낸 횟수를 키(Key)라고 하면 알파벳은 총 26자이므로, 가능한 키의 갯수는 26개이다.

* ### 암호학에서 가능한 모든 키의 집합을 키 공간(Key Space)라고 하며, 이를 이용하여 다시 표현하면 카이사르 암호에서 키 공간의 크기는 26이다.

* ### 알파벳을 A부터 Z를 0부터 25까지 대응시키면, n글자씩 밀어내는 카이사르 암호를 아래의 합동식을 표현할 수 있다.

<br>

```
E≀(x) ≡ (x+n) mod 26
D≀(x) ≡ (x-n) mod 26
```

<br><br>

  ## 춤추는 인형과 코드북 암호

  <br>

* ### 카이사르 암호는 알파벳을 밀어서 암호화하는 특성상, 키 공간의 크기가 작기 때문에 컴퓨터를 사용하면 쉽게 복호화된다.

* ### 조금더 복잡한 단일 치환 암호로는 셜록 홈즈에 나온 춤추는 인형 암호가 있는데, 이 암호에서는 사람 한 명이 글자 하나에 대응된다.

<br>

![이미지](https://kr.object.ncloudstorage.com/dreamhack-content/page/070fe8ef6b04f691dba7da760289eee579e80062ac701cd8fb01def3c9119ec8.png)

<br>

* ### 춤추는 인형 암호처럼 모든 알파벳을 서로 다른 기호와 무작위로 일대일 대응시켜 치환하면 키 공간의 크기는 26!이 된다.

* ### 이 정도 크기의 키 공간은 현대의 컴퓨터로도 전부 탐색하기 어렵지만, 단일 치환 암호는 언어가 지닌 통계적 특성이 유지된다는 단점이 있다.

* ### 통계적으로, 영어 문장에서 가장 많이 사용되는 알파벳은 e인데, 즉 단일 치환 암호가 적용된 암호문에서 b가 가장 많이 나온다면 e가 치환된 것이라고 추측할 수 있다. 이 특성을 이용하면, 일반적인 영문 단일 치환 암호문은 어렵지 않게 해독될 수 있다.

* ### 난수표나 코드북을 이용한 단일 치환 암호는 현재도 종종 사용되는데, 송신자와 수신자가 책을 정하고 송신자가 책의 페이지 x와 단어의 인덱스 y를 보내면 수신자는 책 x 페이지의 y번째 단어를 확인하여 송신자의 메세지를 해독한다. 이 암호 체계는 공작원에게 지령을 전달하는 목적으로 최근에도 쓰인다.

<br><br>

- - -

<br>

## **다중 문자 치환 암호**

<br>

* ### 다중 문자 치환 암호는 단일 문자치환 암호와 달리 평뮨의 한 문자가 암호문에서 여러 종류의 문자로 치환될 수 있다.

* ### 대표정인 다중 문자 치환 암호로는 비제네르 암호(Vigenere Cipher)가 있는데, 비제네르 암호에서 암호화와 복호화는 미리 정해진 키워드를 통해 이루어진다.

* ### 'SKY'라는 키워드로 평문 'DReAMHACK'을 비제네르 암호화하는 과정은 다음과 같다.

<br>

![이미지](https://kr.object.ncloudstorage.com/dreamhack-content/page/64da3c376c5c6d78a1447bdf41258dc0788662c60b9b8df77cd5b2b95600c9e2.png)

<br>

* ### 우선 이 비제네르 표에서, 'S','K','Y' 행을 고르고, 키워드를 반복하며 키워드의 각 행에서 평문의 문자에 대응되는 문자로 평문을 치환한다.

* ### A부터 Z를 0부터 25까지 대응시키면 비제네르 암호를 다음의 합동식으로 표현할 수 있다.

* ### 여기서 C는 암호문, M은 평문, K는 키워드를 의미하고, X≀는 X의 i번쨰 요소를 나타낸다.

<br>

```
C≀ = EK(M≀) ≡ (M≀ + K≀) mod 26
M≀ = DK(C≀)≡ (C≀ - K≀) mod 26
```

<br><br><br>

- - -

<br>

## **전치 암호**

<br>

* ### 전치 암호(Transposition Cipher)는 평문을 구성하는 문자들의 순서를 재배열하여 암호문을 만든다.

* ### 평문을 정해진 길이의 블록들로 나누고, 규칙을 적용하여 블록 안의 문자들을 재배치한다.

* ### 예를 들어 블록의 길이가 3이고 키가 (3,1,2)일 때 평문 DREAM HACK의 암호화는 아래와 같이 이루어진다.

<br>

![이미지](https://kr.object.ncloudstorage.com/dreamhack-content/page/dde671d51ab23339aadc6ca583ed28ea5bf948abfabe9ab7f6f59af6cd47ec31.png)

<br>

* ### 전치 암호의 대표적인 예로는 기원전 450년에 고대 그리스인들이 발견한 스키테일 암호(Scytale)가 있다.

* ### 이 암호는, 먼저 메세지를 교환할 두 사람이 같은 크기의 나무봉을 제작하면, 그 뒤 송신자는 종이 테이프를 나무봉에 감고, 테이프 위에 세로로 메세지를 기입하여 암호문을 만든다.

* ### 종이테이프를 풀어내면 순서가 뒤섞여 메세지를 읽을 수 없지만, 같은 나무봉을 가진 수신자는 테이프를 다시 나무봉에 감아서 이를 해석할 수 있다.

<br>

- - -

<br>

## **고전 암호 공격**

<br>

* ### 안전하다고 여겼던 고전 암호들은 암호 분석 도구와 기술의 발달로 쉽게 분석되었다.

* ### 고전 암호를 공격하는 방법으로는 대표적으로 진수 키 탐색 공격(Exhaustive Key Search Attack)과 빈도수 분석(Frequency Analysis)이 있다.

<br>

## 전수 키 탐색 공격

<br>

* ### 전수 키 탐색 공격은 평문과 암호문을 알 때, 키 공간을 전부 탐색하며 주어진 암호문과 같은 암호문을 생성하는 키를 찾는 방법이다.

* ### 굉장히 단순한 공격 방법이지만 키 공간의 크기가 작다면 빠른 시간 안에 키를 찾고, 암호를 해독할 수 있다.

* ### 단일 치환 암호인 카이사르 암호는 키 공간이 26이므로 매우 작기 때문에 전수 키 탐색 공격에 취약한다.

<br><br>

## 빈도수 공격

<br>

* ### 단일 치환 암호는 평문의 문자와 암호문의 문자가 항상 일대일 대응을 이루기 때문에 평문의 통계적 특성이 유지된다.

* ### 예를 들어, 영어 문장에서 각 알파벳이 사용되는 빈도를 그래프로 표현하면 아래와 같은데, 이런 특성은 문자를 단일 치환해도 유지된다.

<br>

![이미지](https://kr.object.ncloudstorage.com/dreamhack-content/page/e2bc96d3250c2bd1489786150d374472e6d1e177c647d4851b01fc4df0fdebfe.png)

<br>

* ### 아래에 따르면 평문의 E를 A로 치환해서 암호문을 만들었다면, 암호문에서 가장 많이 등장하는 알파벳이 A일 가능성이 높다.

* ### 이런 추측을 바탕으로 암호문을 복구하는 것을 빈도수 분석(frequency analysis)라고 한다.

* ### 이는 암호문이 어떤 언어로 구성되어 있어도 대상 언어의 특성을 안다면 시도해볼 만 하며, 다중 치환 암호는 이러한 통계적 특성이 사라지기 때문에 빈도수 공격으로부터 비교적 안전하다고 알려져 있다.