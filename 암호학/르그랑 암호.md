# **르그랑 암호**

<br>

* ### 르그랑 암호는 1800년대 미국의 소설가 애드거 앨런 포우의 소설 황금딱정벌레에 등장한다.

* ### 황금 딱정벌레의 등장인물 르그랑은 일반 사람이 알아보기 힘든 한 문장을 천재적인 머리로 해독해내고, 해적선장 키드가 숨겨둔 보물궤짝을 찾아낸다.

* ### 르그랑이 해독한 키드 암호문으로 돌아가보면 소설 속에서 르그랑이 발견한 규칙은 다음과 같다.

<br>

![이미지](data:image/png;base64,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)

<br>

* ### 해당 코드북을 바탕으로 암호화 기능과 복호화 기능을 파이썬으로 만들어보면, 아래와 같이 만들 수 있다.

```py
def makeCodebook():
    decbook = {'5':'a','2':'b','#':'d','8':'e','1':'f','3':'g','4':'h','6':'i','0':'l','9':'m','*':'n','%':'o','=':'p','(':'r',')':'s',';':'t','?':'u','@':'v',':':'y','7':' '}
    # 복호화를 위한 코드북을 사전 자료 형태로 생성
    encbook = {}
    for k in decbook:
        val = decbook[k]
        encbook[val] = k
    # encbook은 반대로, key와 value를 반대로 설정
    return encbook, decbook

def encrypt(msg, encbook):
    for c in msg:
        if c in encbook:
            msg = msg.replace(c, encbook[c])
    # 암호화인데, 인자로 받은 msg(평문)를 encbook을 이용해 암호화하고 암호화한 msg(암호문)를 return함
    return msg

def decrypt(msg, decbook):
    for c in msg:
        if c in decbook:
            msg = msg.replace(c, decbook[c])
    #복호화인데, 인자로 받은 msg(암호문)을 decbook을 이용해 복호화하고 복호화된 msg(평문)을 return함
    return msg

if __name__ == '__main__': # 이 곳에서 시작
    plaintext = 'I love you with all my heart' 

    encbook, decbook = makeCodebook()

    ciphertext = encrypt(plaintext, encbook)
    print(ciphertext)

    deciphertext = decrypt(ciphertext, decbook)
    print(deciphertext)
```