# **AMI란**

<br>

### `AMI(Amazon Machine Image)`란 **EC2 인스턴스를 실행하기 위한 정보를 모은 단위**이다.

<br>

### `EC2`를 실행시키기 위해선 OS, 저장공간 용량이나 아키텍처 등 여러 정보가 필요한데 이런 **세팅 정보(템플릿)를 저장한 단위**이다.

<br>

![image](https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/images/architecture_ami_instance.png)

<br>

### AMI를 사용해 **현재의 EC2 세팅 상태(템플릿)을 복제**하여 **다른 계정, 리전 등에 전달**하거나 **다른 사람에게 배포**할 수 있다.


<br>

> 예를 들어, 애플리케이션이 웹사이트인 경우, 웹 서버와 관련해서 사용되는 여러 콘텐츠 등 여러 소프트웨어가 포함된 AMI를 이용하여 더 효율적으로 만들 수 있다.

<br>

<br>


---

<br>

## **AMI 구성**

<br>

+ **1개 이상의 EBS 스냅샷**

+ 인스턴스가 어떤 **EBS 스냅샷과 연결되어있는지에 대한 정보**
+ instance store가 루트디바이스인 경우 루트 볼륨에 대한 템플릿
+ 사용 권한
+ EBS 블록 디바이스 맵핑 (EBS가 어떤 용량으로 몇 개 붙는지)

<br>

> Amazon EC2 인스턴스 스토어가 지원하는 AMI와 Amazon EBS에서 지원하는 AMI 중에서 선택할 수 있는데, **시작 속도가 빠르고 영구 스토리지를 사용하는 Amazon EBS 지원 AMI를 사용하는 것이 좋다.**
>
> **C3, D2, G2, I2, M3 및 R3 같은 인스턴스 유형만 인스턴스 스토어 볼륨을 루트 디바이스로 지원**한다.

<br><br>

---

<br>

## **Snapshot**

<br>

### 스냅샷은 **EBS를 저장하는 효율적인 방법**으로, **특정 시간의 EBS 볼륨 상태의 저장본**을 말한다. 실수 등으로 데이터를 복구해야 할 시, 스냅샷으로 돌아갈 수 있다.

<br>

### 스냅샷은 OS와 별개로 **데이터만 백업**하고 싶은 경우, **스냅샷을 만들고 그걸 기반으로 여러 AMI를 만들고 싶은** 경우 사용된다. 또한, 통째로 저장하는게 아닌 데이터의 변화만 저장하여, 효율적이다.

<br>

![이미지](https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/images/snapshot_1a.png)

<br>

> **스냅샷 파일은 주로 S3에 저장된다.**

<br>

<br>

---

<br>

## **AMI 생성 과정**

<br>

### 1. EBS의 스냅샷을 찍는다.
### 2. 스냅샷을 S3에 저장한다.
### 3. 스냅샷을 기반으로 AMI를 만든다.
### 4. AMI를 가지고 EC2를 실행하거나, 다른 사람에게 공유하거나, 복사 한다.

<br><br>

---

<br>

## **AMI와 Snapshot의 차이점**

<br>

### 둘 다 **EBS를 백업**한다는 점은 같으나, `AMI`는 **EC2 인스턴스에 연결된 모든 EBS 볼륨을 동시에 백업**하지만, `Snapshot`은 **사용자가 선택한 EBS Volume을 백업**한다.

<br>

### 그리고, `AMI`는 바로 EC2 인스턴스를 생성할 수 있고, `Snapshot`은 AMI를 생성하는 과정을 거쳐야 한다.

<br>

### 마지막으로, 주기적인 데이터 백업이 필요한 경우 `AMI` 메뉴 상에는 주기적으로 AMI를 생성하는 메뉴가 없지만, `Snapshot`에는 `EBS Snapshot` 생명 주기 정책을 이용해 주기적으로 `EBS Volume`을 백업하는 기능이 있다.